---
title: "Data_Exploration"
author: "Nadia Swit"
date: "4/26/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

NOAA Habitat restoration in Areas of Concern
NOAA has performing several large-scale restoration projects in the Great Lakes Region. Focusing on Areas of Concern (AOC), which are environmentally degraded areas within the Great Lakes Basin, these systems have several impairments to their beneficial uses as a result of human activity at the local level. Restoration is carried out through the Great Lakes Restoration Initiative, and is aimed at improving and delisting these impairments and AOCs. Muskegon Lake, located in Michigan, is projected to be delisted as an AOC in 2022-20226.

Muskegon is a 4,149 acre-drowned river mouth lake that flows into the eastern shore of Lake Michigan. The Muskegon Lake AOC includes several tributaries that flow into Muskegon Lake, including Ruddiman Creek, Bear Creek, and Bear Lake. Muskegon Lake was designated an AOC through the Great Lakes Water Quality Agreement in 1987 due to ecological impairments caused by sediment contamination with mercury and other heavy meatals, excessive fill and loss of natural shorelines along the Lake and large-scale impairments to critical wetlands, high levels of nutrients and other toxins enter the lake, and degredation of overall water quality.

However, there are several ongoing restoration and remediation projects that are improving Muskegon Lake, including the Lower Muskegon River habitat restoration project. Funded by the Great Lakes Restoration Initiative (GLRI), National Oceanic and Atmospheric Administration (NOAA) and Great Lakes Commission (GLC), the project goals were to improve habitat for fish and wildlife by restoring wetlands, reconnecting floodplain wetlands with the river, and restoring fish habitat and passage. The project will restore 49.1 acres of emergent wetland and soften 2,825 feet of shoreline by reconnecting the Muskegon River with its restored wetland floodplain by removing dikes (https://www.glc.org/wp-content/uploads/Habitat-Muskegon-Lake-AOC-Lower-Muskegon-River-Fact-Sheet-FINAL-February-2020.pdf). The prject site is owned by Muskegon Countyad used to be a celery farm that was separated from the river by a series of constructed dikes.

This restoration project was slated to be completed in 2020, with monitoring and final restoration work to be completed in 2021. Following the most recent project update in January 2021, it appears the implementation timeline moved forward with excavation and woody structure installation for fish and wildlife habitat. Water drawdown and native vegetation plantings and seeding was anticipated to being in spring 2021 (https://wmsrdc.org/wp-content/uploads/2016/02/LMR-Update.pdf).

This analysis aims to evaluate several questions related to the restoration project and water quality in the lake:
1. What are the locations of water quality gages near Mukegon Lake and its tributaries?
2. Given the land use history, how was the water quality change between it being a celery farm, after its decommission of a celery farm and left fallow, during the construction process, and post construction?

#Checking for Water Quality

```{r}
library(tidyverse)
library(lubridate)
library(cowplot)
library(dataRetrieval)
library(LAGOSNE)
library(sf)
library(maps)


theme_set(theme_classic())
options(scipen = 4)
```

```{r}
# Load LAGOSNE data into R session
LAGOSdata <- lagosne_load() #loads as list instead of df
names(LAGOSdata)

# Exploring the data types that are available
LAGOSlocus <- LAGOSdata$locus 
LAGOSstate <- LAGOSdata$state
LAGOSnutrient <- LAGOSdata$epi_nutr

# Tell R to treat lakeid as a factor, not a numeric value
LAGOSlocus$lagoslakeid <- as.factor(LAGOSlocus$lagoslakeid) #won't treat as continuous variable anymore
LAGOSnutrient$lagoslakeid <- as.factor(LAGOSnutrient$lagoslakeid)

#Filter for michigan
states <- st_as_sf(map(database = "state", plot = TRUE, fill = TRUE, col = "white"))
states.mi <- filter(states, ID == "michigan")
                        

# Create a data frame to visualize parameters
Lakecombined <- 
  left_join(LAGOSnutrient, LAGOSlocus) %>%
  left_join(., LAGOSstate) %>%
  filter(!is.na(states.mi)) %>%
  select(lagoslakeid, sampledate, secchi, tn, tp, lake_area_ha, maxdepth, nhd_lat, nhd_long, state)


#Join and filter for Michigan
LAGOSMI <- LAGOSlocus %>% 
  left_join(LAGOSlocus, LAGOSstate, by= "state_zoneid") %>% #join locations
  left_join(LAGOSlocus, LAGOSnutrient, by= "lagoslakeid") %>% 
  select(lagoslakeid, sampledate,chla, tp, tn, secchi, gnis_name, lake_area_ha, state, state_name,
         nhd_lat, nhd_long) %>% 
  filter(state_name == "Michigan")
  
LAGOStrophic <- LAGOSnutrient %>%
  left_join(., LAGOSlocations, by = "lagoslakeid") %>% #., refers to dataframe that is the same from the pipe; left_join needs to references
  select(lagoslakeid, sampledate, chla, tp, secchi, #select certain columns (maybe can do $ after df)
         gnis_name, lake_area_ha, state, state_name) %>%
  mutate(sampleyear = year(sampledate), 
         samplemonth = month(sampledate)) %>%
  drop_na(chla, tp, secchi, state) #drop na in certain columns  

#Want to only select Michigan from state data
LAGOSstateMI <- LAGOSstate %>% 
  filter(state_name=="Michigan")

```



